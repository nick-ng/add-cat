import"../chunks/DsnmJJEf.js";import{i as Z}from"../chunks/DfDamSP_.js";import{p as ee,o as te,f as h,h as oe,g as D,b as p,c as ae,i as c,m as x,$ as ie,s as u,d as i,r as l,j as e,n as le,t as g,e as k,a as re,k as se}from"../chunks/C6Bx9uxh.js";import{i as y}from"../chunks/BbmR1Je_.js";import{e as ne,s as G}from"../chunks/CBtMWNv9.js";import{b as de}from"../chunks/D4bmvf-m.js";import{f as C,g as ce,m as ue}from"../chunks/B4FO3W-e.js";var ve=h("<div> </div>"),pe=h("<div> </div>"),he=h("<p>Please upload two hideouts.</p>"),fe=h("<option> </option>"),me=h("<h3>Choose a reference decoration</h3> <div><select><option>Choose a decoration</option><!></select></div>",1),_e=h('<div class="mt-2"><a class="button-default no-underline opaque inline-block">Download (Right-Click, Save As)</a></div>'),ge=h(`<div class="max-w-[130ch] mx-auto"><h1 class="mt-1">Migrate Hideout</h1> <p>Move all the decorations from one hideout to another.</p> <div class="flex flex-row justify-center mt-2"><div class="basis-prose"><div class="flex flex-row gap-2"><div class="flex flex-col"><label class="button-default inline-block cursor-pointer relative">Upload Old Hideout <input class="w-0 opacity-0 text-sm text-left block absolute top-0 left-0" type="file" accept=".hideout"/></label> <!></div> <div class="inline-block"><label class="button-default inline-block cursor-pointer relative">Upload New Hideout <input class="w-0 opacity-0 text-sm text-left block absolute top-0 left-0" type="file" accept=".hideout"/></label> <!></div></div> <!> <!></div> <div class="basis-prose"><h2>Instructions</h2> <ol class="ml-4 list-decimal"><li>Export your current hideout.</li> <li>Switch to the hideout you want (talk to Helena).</li> <li>Put/move a reference decoration, e.g. the Stash, to where you want in the new hideout, . <ul class="ml-4 list-disc"><li>This tool will migrate all the decorations in your old hideout so they are in the same
							place relative to this reference decoration.</li></ul></li> <li>Export the new hideout.</li> <li>Upload both hideouts by clicking on the "Upload Old Hideout" and "Upload New Hideout"
					buttons.</li> <li>Choose the decoration you added in step 3.</li> <li>Download your new hideout. If that doesn't work, you might have to right-click on the
					button and choose "Save As...". Be careful not to overwrite either of your original
					hideouts in case it doesn't turn out the way you want and you need to load your old
					hideout.</li> <li>Import your new hideout in Path of Exile.</li></ol></div></div></div>`);function He(L,j){ee(j,!1);const w="PUX_HIDEOUT_MIGRATE",b="PUX_CHOSEN_DOODAD_1",S=(t,o="")=>{const a=JSON.parse(t),d={hideoutString:t,hideoutObject:a,hideoutName:a.hideout_name||"Invalid",isValid:!!a.hideout_name,uploadTimestampMs:Date.now(),doodadCounts:ce(t,!0)};return o&&(localStorage.setItem(`${w}_${o}_STRING`.toLocaleUpperCase(),d.hideoutString),localStorage.setItem(`${w}_${o}_TIMESTAMP`.toLocaleUpperCase(),d.uploadTimestampMs.toString())),d},N=t=>{const o=localStorage.getItem(`${w}_${t}_STRING`.toLocaleUpperCase());return o?{...S(o),uploadTimestampMs:parseInt(localStorage.getItem(`${w}_${t}_TIMESTAMP`.toLocaleUpperCase())||"0",0)}:null};let f=x([]),r=x(null),s=x(null),n=x("");te(()=>{c(r,N("old")),c(s,N("new")),c(n,localStorage.getItem(b)||"")}),Z();var T=ge();oe(t=>{ie.title="Migrate Hideout"});var U=u(i(T),4),A=i(U),E=i(A),H=i(E),I=i(H),X=u(i(I));l(I);var K=u(I,2);{var Y=t=>{var o=ve(),a=i(o,!0);l(o),g(()=>k(a,e(r).hideoutName)),p(t,o)};y(K,t=>{e(r)&&t(Y)})}l(H);var M=u(H,2),$=i(M),q=u(i($));l($);var B=u($,2);{var F=t=>{var o=pe(),a=i(o,!0);l(o),g(()=>k(a,e(s).hideoutName)),p(t,o)};y(B,t=>{e(s)&&t(F)})}l(M),l(E);var P=u(E,2);{var J=t=>{var o=he();p(t,o)},V=t=>{var o=me(),a=u(re(o),2),d=i(a);g(()=>{e(n),se(()=>{e(r),e(s)})});var O=u(i(d));ne(O,3,()=>C([e(r),e(s)]),(v,m)=>`${v}-${m}`,(v,m)=>{var _=fe(),W=i(_,!0);l(_);var R={};g(()=>{k(W,e(m)),R!==(R=e(m))&&(_.value=(_.__value=e(m))??"")}),p(v,_)}),l(d),l(a),de(d,()=>e(n),v=>c(n,v)),D("change",d,v=>{localStorage.setItem(b,v.currentTarget.value)}),p(t,o)};y(P,t=>{!e(r)||!e(s)?t(J):t(V,!1)})}var z=u(P,2);{var Q=t=>{var o=_e(),a=i(o);l(o),g((d,O)=>{G(a,"href",d),G(a,"download",O)},[()=>`data:text/plain;charset=utf-8,${ue(e(n),e(r),e(s))}`,()=>`${e(s).hideoutName.replaceAll(" ","-")}_${e(r).hideoutName.replaceAll(" ","-")}_${e(n)}.hideout`.replaceAll(" ","_")]),p(t,o)};y(z,t=>{e(r)&&e(s)&&C([e(r),e(s)]).includes(e(n))&&t(Q)})}l(A),le(2),l(U),l(T),D("change",X,async t=>{if(c(f,[]),t.currentTarget.files)for(const o of[...t.currentTarget.files])try{const a=await o.text();c(r,S(a,"old")),(!e(n)||!C([e(r),e(s)]).includes(e(n)))&&c(n,""),localStorage.setItem(b,"")}catch(a){e(f).push(`Error when loading ${o.name}`),a instanceof Error&&e(f).push(a.message)}}),D("change",q,async t=>{if(c(f,[]),t.currentTarget.files)for(const o of[...t.currentTarget.files])try{const a=await o.text();c(s,S(a,"new")),c(n,""),localStorage.setItem(b,"")}catch(a){e(f).push(`Error when loading ${o.name}`),a instanceof Error&&e(f).push(a.message)}}),p(L,T),ae()}export{He as component};
